---
title: Usar a API de Pesquisa da Microsoft para consultar dados
description: Utilizando a API de pesquisa, os aplicativos podem pesquisar os dados do Microsoft 365 no contexto do usuário autenticado
localization_priority: Priority
author: nmoreau
ms.prod: search
doc_type: resourcePageType
ms.openlocfilehash: 36e953866de02e81910d1b75397e90cf7fdd0f29
ms.sourcegitcommit: 7ceec757fd82ef3fd80aa3089ef46d3807aa3aa2
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 10/09/2020
ms.locfileid: "48405320"
---
# <a name="use-the-microsoft-search-api-to-query-data"></a><span data-ttu-id="e22d6-103">Usar a API de Pesquisa da Microsoft para consultar dados</span><span class="sxs-lookup"><span data-stu-id="e22d6-103">Use the Microsoft Search API to query data</span></span>

[!INCLUDE [beta-disclaimer](../../includes/beta-disclaimer.md)]

<span data-ttu-id="e22d6-104">Você pode utilizar a API de Pesquisa da Microsoft para consultar os dados do Microsoft 365 nos seus aplicativos.</span><span class="sxs-lookup"><span data-stu-id="e22d6-104">You can use the Microsoft Search API to query Microsoft 365 data in your apps.</span></span>

<span data-ttu-id="e22d6-105">As solicitações de pesquisa são executadas no contexto do usuário conectado, identificado usando um [token de acesso com permissões delegadas](/graph/auth-v2-user).</span><span class="sxs-lookup"><span data-stu-id="e22d6-105">Search requests run in the context of the signed-in user, identified using an [access token with delegated permissions](/graph/auth-v2-user).</span></span>

[!INCLUDE [search-api-deprecation](../../includes/search-api-deprecation.md)]

## <a name="common-use-cases"></a><span data-ttu-id="e22d6-106">Casos de uso comuns</span><span class="sxs-lookup"><span data-stu-id="e22d6-106">Common use cases</span></span>

<span data-ttu-id="e22d6-107">A API de pesquisa da Microsoft fornece um método de [consulta](../api/search-query.md) para pesquisar os dados na Pesquisa da Microsoft, no qual você passa um[searchRequest](searchRequest.md) no corpo da solicitação, definindo as especificações da pesquisa.</span><span class="sxs-lookup"><span data-stu-id="e22d6-107">The Microsoft Search API provides a [query](../api/search-query.md) method to search across your data in Microsoft Search, where you pass a [searchRequest](searchRequest.md) in the request body, defining the specifics of your search.</span></span>

<span data-ttu-id="e22d6-108">Essa seção lista os casos de uso comuns do método de **consulta**, com base nas propriedades e parâmetros definidos no corpo da \*\*consulta \*\* [searchRequest](searchRequest.md).</span><span class="sxs-lookup"><span data-stu-id="e22d6-108">This section lists the common use cases of the **query** method, based on the properties and parameters you set in the **query** [searchRequest](searchRequest.md) body.</span></span>

<span data-ttu-id="e22d6-p101">Search requests run on behalf of the user. Search results are scoped to enforce any access control applied to the items.  For example, in the context of files, permissions on the files are evaluated as part of the search request. Users cannot access more items in a search than they can otherwise obtain from a corresponding GET operation with the same permissions and access control.</span><span class="sxs-lookup"><span data-stu-id="e22d6-p101">Search requests run on behalf of the user. Search results are scoped to enforce any access control applied to the items.  For example, in the context of files, permissions on the files are evaluated as part of the search request. Users cannot access more items in a search than they can otherwise obtain from a corresponding GET operation with the same permissions and access control.</span></span>

| <span data-ttu-id="e22d6-113">Casos de uso</span><span class="sxs-lookup"><span data-stu-id="e22d6-113">Use cases</span></span> | <span data-ttu-id="e22d6-114">Propriedades a serem definidas no corpo da solicitação de consulta</span><span class="sxs-lookup"><span data-stu-id="e22d6-114">Properties to define in the query request body</span></span> |
|:------------------|:---------|
|[<span data-ttu-id="e22d6-115"> Resultados da pesquisa de escopo com base em tipos de entidade</span><span class="sxs-lookup"><span data-stu-id="e22d6-115">Scope search results based on entity types</span></span>](#scope-search-based-on-entity-types)| <span data-ttu-id="e22d6-116">**entityTypes**</span><span class="sxs-lookup"><span data-stu-id="e22d6-116">**entityTypes**</span></span> |
|[<span data-ttu-id="e22d6-117">Resultados da página</span><span class="sxs-lookup"><span data-stu-id="e22d6-117">Page results</span></span>](#page-search-results) | <span data-ttu-id="e22d6-118">**from** e **size**</span><span class="sxs-lookup"><span data-stu-id="e22d6-118">**from** and **size**</span></span> |
|[<span data-ttu-id="e22d6-119">Obter os emails mais relevantes</span><span class="sxs-lookup"><span data-stu-id="e22d6-119">Get the most relevant emails</span></span>](#get-the-most-relevant-emails) | <span data-ttu-id="e22d6-120">**enableTopResults**</span><span class="sxs-lookup"><span data-stu-id="e22d6-120">**enableTopResults**</span></span> |
|[<span data-ttu-id="e22d6-121">Obter as propriedades selecionadas</span><span class="sxs-lookup"><span data-stu-id="e22d6-121">Get selected properties</span></span>](#get-selected-properties) | <span data-ttu-id="e22d6-122">**campos**</span><span class="sxs-lookup"><span data-stu-id="e22d6-122">**fields**</span></span> |
|[<span data-ttu-id="e22d6-123">Usar KQL em termos de consulta</span><span class="sxs-lookup"><span data-stu-id="e22d6-123">Use KQL in query terms</span></span>](#keyword-query-language-kql-support) | <span data-ttu-id="e22d6-124">**query**</span><span class="sxs-lookup"><span data-stu-id="e22d6-124">**query**</span></span> |
|[<span data-ttu-id="e22d6-125">Classificar resultados de pesquisa</span><span class="sxs-lookup"><span data-stu-id="e22d6-125">Sort search results</span></span>](#sort-search-results)| <span data-ttu-id="e22d6-126">**sort**</span><span class="sxs-lookup"><span data-stu-id="e22d6-126">**sort**</span></span> |
|[<span data-ttu-id="e22d6-127">Refinar os resultados usando agregações</span><span class="sxs-lookup"><span data-stu-id="e22d6-127">Refine results using aggregations</span></span>](#refine-results-using-aggregations)| <span data-ttu-id="e22d6-128">**aggregations**</span><span class="sxs-lookup"><span data-stu-id="e22d6-128">**aggregations**</span></span> |
|[<span data-ttu-id="e22d6-129">Pesquisar entre conectores do Graph</span><span class="sxs-lookup"><span data-stu-id="e22d6-129">Search across Graph connectors</span></span>](/graph/search-concept-custom-types)| <span data-ttu-id="e22d6-130">**contentSources**</span><span class="sxs-lookup"><span data-stu-id="e22d6-130">**contentSources**</span></span> |

## <a name="scope-search-based-on-entity-types"></a><span data-ttu-id="e22d6-131">Pesquisa de escopo com base em tipos de entidade</span><span class="sxs-lookup"><span data-stu-id="e22d6-131">Scope search based on entity types</span></span>

<span data-ttu-id="e22d6-p102">Define the scope of the search request using the **entityTypes** property in the **query** request payload. The following table describes the types available to query and the supported permissions to access the data.</span><span class="sxs-lookup"><span data-stu-id="e22d6-p102">Define the scope of the search request using the **entityTypes** property in the **query** request payload. The following table describes the types available to query and the supported permissions to access the data.</span></span>

| <span data-ttu-id="e22d6-134">EntityType</span><span class="sxs-lookup"><span data-stu-id="e22d6-134">EntityType</span></span> | <span data-ttu-id="e22d6-135">Escopo de permissão necessário para acessar os itens</span><span class="sxs-lookup"><span data-stu-id="e22d6-135">Permission scope required to access the items</span></span>| <span data-ttu-id="e22d6-136">Origem</span><span class="sxs-lookup"><span data-stu-id="e22d6-136">Source</span></span>| <span data-ttu-id="e22d6-137">Comentário</span><span class="sxs-lookup"><span data-stu-id="e22d6-137">Comment</span></span>|
|:------------------|:---------|:---------|:---------|
|[<span data-ttu-id="e22d6-138">message</span><span class="sxs-lookup"><span data-stu-id="e22d6-138">message</span></span>](message.md)|<span data-ttu-id="e22d6-139">Mail.Read, Mail.ReadWrite</span><span class="sxs-lookup"><span data-stu-id="e22d6-139">Mail.Read, Mail.ReadWrite</span></span>| <span data-ttu-id="e22d6-140">Exchange Online</span><span class="sxs-lookup"><span data-stu-id="e22d6-140">Exchange Online</span></span>| <span data-ttu-id="e22d6-141">Mensagens de email.</span><span class="sxs-lookup"><span data-stu-id="e22d6-141">Email messages.</span></span>|
|[<span data-ttu-id="e22d6-142">event</span><span class="sxs-lookup"><span data-stu-id="e22d6-142">event</span></span>](event.md) |<span data-ttu-id="e22d6-143">Calendars.Read, Calendars.ReadWrite</span><span class="sxs-lookup"><span data-stu-id="e22d6-143">Calendars.Read, Calendars.ReadWrite</span></span>| <span data-ttu-id="e22d6-144">Exchange Online</span><span class="sxs-lookup"><span data-stu-id="e22d6-144">Exchange Online</span></span>|<span data-ttu-id="e22d6-145">Eventos do calendário.</span><span class="sxs-lookup"><span data-stu-id="e22d6-145">Calendar events.</span></span> |
|[<span data-ttu-id="e22d6-146">unidade</span><span class="sxs-lookup"><span data-stu-id="e22d6-146">drive</span></span>](drive.md)|<span data-ttu-id="e22d6-147">Files.Read.All, Files.ReadWrite.All, Sites.Read.All, Sites.ReadWrite.All</span><span class="sxs-lookup"><span data-stu-id="e22d6-147">Files.Read.All, Files.ReadWrite.All, Sites.Read.All, Sites.ReadWrite.All</span></span>| <span data-ttu-id="e22d6-148">SharePoint</span><span class="sxs-lookup"><span data-stu-id="e22d6-148">SharePoint</span></span> | <span data-ttu-id="e22d6-149">Bibliotecas de documentos.</span><span class="sxs-lookup"><span data-stu-id="e22d6-149">Document libraries.</span></span>|
|[<span data-ttu-id="e22d6-150">driveItem</span><span class="sxs-lookup"><span data-stu-id="e22d6-150">driveItem</span></span>](driveitem.md)|<span data-ttu-id="e22d6-151">Files.Read.All, Files.ReadWrite.All, Sites.Read.All, Sites.ReadWrite.All</span><span class="sxs-lookup"><span data-stu-id="e22d6-151">Files.Read.All, Files.ReadWrite.All, Sites.Read.All, Sites.ReadWrite.All</span></span>| <span data-ttu-id="e22d6-152">SharePoint e OneDrive</span><span class="sxs-lookup"><span data-stu-id="e22d6-152">SharePoint and OneDrive</span></span> | <span data-ttu-id="e22d6-153">Arquivos, pastas, páginas e notícias.</span><span class="sxs-lookup"><span data-stu-id="e22d6-153">Files, folders, pages, and news.</span></span> |
|[<span data-ttu-id="e22d6-154">list</span><span class="sxs-lookup"><span data-stu-id="e22d6-154">list</span></span>](list.md)|<span data-ttu-id="e22d6-155">Sites.Read.All, Sites.ReadWrite.All</span><span class="sxs-lookup"><span data-stu-id="e22d6-155">Sites.Read.All, Sites.ReadWrite.All</span></span>| <span data-ttu-id="e22d6-156">SharePoint e OneDrive</span><span class="sxs-lookup"><span data-stu-id="e22d6-156">SharePoint and OneDrive</span></span> | <span data-ttu-id="e22d6-p103">Lists. Note that document libraries are also returned as lists.</span><span class="sxs-lookup"><span data-stu-id="e22d6-p103">Lists. Note that document libraries are also returned as lists.</span></span> |
|[<span data-ttu-id="e22d6-159">listItem</span><span class="sxs-lookup"><span data-stu-id="e22d6-159">listItem</span></span>](listitem.md)|<span data-ttu-id="e22d6-160">Sites.Read.All, Sites.ReadWrite.All</span><span class="sxs-lookup"><span data-stu-id="e22d6-160">Sites.Read.All, Sites.ReadWrite.All</span></span>| <span data-ttu-id="e22d6-161">SharePoint e OneDrive</span><span class="sxs-lookup"><span data-stu-id="e22d6-161">SharePoint and OneDrive</span></span> | <span data-ttu-id="e22d6-p104">List items. Note that files and folders are also returned as list items; **listItem** is the super class of **driveItem**.</span><span class="sxs-lookup"><span data-stu-id="e22d6-p104">List items. Note that files and folders are also returned as list items; **listItem** is the super class of **driveItem**.</span></span> |
|[<span data-ttu-id="e22d6-164">site</span><span class="sxs-lookup"><span data-stu-id="e22d6-164">site</span></span>](site.md)|<span data-ttu-id="e22d6-165">Sites.Read.All, Sites.ReadWrite.All</span><span class="sxs-lookup"><span data-stu-id="e22d6-165">Sites.Read.All, Sites.ReadWrite.All</span></span>| <span data-ttu-id="e22d6-166">SharePoint</span><span class="sxs-lookup"><span data-stu-id="e22d6-166">SharePoint</span></span> | <span data-ttu-id="e22d6-167">Sites no SharePoint.</span><span class="sxs-lookup"><span data-stu-id="e22d6-167">Sites in SharePoint.</span></span>|
|[<span data-ttu-id="e22d6-168">externalItem</span><span class="sxs-lookup"><span data-stu-id="e22d6-168">externalItem</span></span>](externalitem.md)|<span data-ttu-id="e22d6-169">ExternalItem.Read.All</span><span class="sxs-lookup"><span data-stu-id="e22d6-169">ExternalItem.Read.All</span></span>| <span data-ttu-id="e22d6-170">Conectores do Microsoft Graph</span><span class="sxs-lookup"><span data-stu-id="e22d6-170">Microsoft Graph connectors</span></span>| <span data-ttu-id="e22d6-171">Todo o conteúdo está absorvido pela API dos conectores do Microsoft Graph.</span><span class="sxs-lookup"><span data-stu-id="e22d6-171">All content ingested with the Microsoft Graph connectors API.</span></span>|

## <a name="page-search-results"></a><span data-ttu-id="e22d6-172">Resultados da pesquisa de página</span><span class="sxs-lookup"><span data-stu-id="e22d6-172">Page search results</span></span>

<span data-ttu-id="e22d6-173">Para controlar a paginação dos resultados da pesquisa, especifique as duas seguintes propriedades no corpo da solicitação **query**:</span><span class="sxs-lookup"><span data-stu-id="e22d6-173">Control pagination of the search results by specifying the following two properties in the **query** request body:</span></span>

- <span data-ttu-id="e22d6-p105">**from** - An integer that indicates the 0-based starting point to list search results on the page. The default value is 0.</span><span class="sxs-lookup"><span data-stu-id="e22d6-p105">**from** - An integer that indicates the 0-based starting point to list search results on the page. The default value is 0.</span></span>

- <span data-ttu-id="e22d6-p106">**size** - An integer that indicates the number of results to be returned for a page. The default value is 25.</span><span class="sxs-lookup"><span data-stu-id="e22d6-p106">**size** - An integer that indicates the number of results to be returned for a page. The default value is 25.</span></span>

<span data-ttu-id="e22d6-178">Observe os seguintes limites se você estiver pesquisando a entidade **event** ou **message**:</span><span class="sxs-lookup"><span data-stu-id="e22d6-178">Note the following limits if you're searching the **event** or **message** entity:</span></span>

- <span data-ttu-id="e22d6-179">**from** deve começar em zero na primeira solicitação de página; caso contrário, a solicitação resultará em um HTTP 400 `Bad request`.</span><span class="sxs-lookup"><span data-stu-id="e22d6-179">**from** must start at zero in the first page request; otherwise, the request results in an HTTP 400 `Bad request`.</span></span>
- <span data-ttu-id="e22d6-180">O máximo de resultados por página (**size**) é 25 por **mensagem** e **evento**.</span><span class="sxs-lookup"><span data-stu-id="e22d6-180">The maximum results per page (**size**) is 25 for **message** and **event**.</span></span> 

<span data-ttu-id="e22d6-p107">There is no upper limit for SharePoint or OneDrive items. A reasonable page size is 200. A larger page size generally incurs higher latency.</span><span class="sxs-lookup"><span data-stu-id="e22d6-p107">There is no upper limit for SharePoint or OneDrive items. A reasonable page size is 200. A larger page size generally incurs higher latency.</span></span>

<span data-ttu-id="e22d6-184">Práticas recomendadas:</span><span class="sxs-lookup"><span data-stu-id="e22d6-184">Best practices:</span></span>

- <span data-ttu-id="e22d6-p108">Specify a smaller first page in the initial request. For example, specify **from** as 0, **size** as 25.</span><span class="sxs-lookup"><span data-stu-id="e22d6-p108">Specify a smaller first page in the initial request. For example, specify **from** as 0, **size** as 25.</span></span>
- <span data-ttu-id="e22d6-p109">Paginate subsequent pages by updating the **from** and **size** properties. You can increase the page size in each subsequent request. The following table shows an example.</span><span class="sxs-lookup"><span data-stu-id="e22d6-p109">Paginate subsequent pages by updating the **from** and **size** properties. You can increase the page size in each subsequent request. The following table shows an example.</span></span>

    | <span data-ttu-id="e22d6-190">Page</span><span class="sxs-lookup"><span data-stu-id="e22d6-190">Page</span></span> | <span data-ttu-id="e22d6-191">from</span><span class="sxs-lookup"><span data-stu-id="e22d6-191">from</span></span> | <span data-ttu-id="e22d6-192">size</span><span class="sxs-lookup"><span data-stu-id="e22d6-192">size</span></span> |
    |:-----|:-----|:-----|
    | <span data-ttu-id="e22d6-193">1</span><span class="sxs-lookup"><span data-stu-id="e22d6-193">1</span></span>    | <span data-ttu-id="e22d6-194">0</span><span class="sxs-lookup"><span data-stu-id="e22d6-194">0</span></span> | <span data-ttu-id="e22d6-195">25</span><span class="sxs-lookup"><span data-stu-id="e22d6-195">25</span></span> |
    | <span data-ttu-id="e22d6-196">2</span><span class="sxs-lookup"><span data-stu-id="e22d6-196">2</span></span>    | <span data-ttu-id="e22d6-197">25</span><span class="sxs-lookup"><span data-stu-id="e22d6-197">25</span></span> | <span data-ttu-id="e22d6-198">50</span><span class="sxs-lookup"><span data-stu-id="e22d6-198">50</span></span> |
    | <span data-ttu-id="e22d6-199">3</span><span class="sxs-lookup"><span data-stu-id="e22d6-199">3</span></span>    | <span data-ttu-id="e22d6-200">75</span><span class="sxs-lookup"><span data-stu-id="e22d6-200">75</span></span> | <span data-ttu-id="e22d6-201">75</span><span class="sxs-lookup"><span data-stu-id="e22d6-201">75</span></span> |
    | <span data-ttu-id="e22d6-202">4</span><span class="sxs-lookup"><span data-stu-id="e22d6-202">4</span></span>    | <span data-ttu-id="e22d6-203">150</span><span class="sxs-lookup"><span data-stu-id="e22d6-203">150</span></span> | <span data-ttu-id="e22d6-204">100</span><span class="sxs-lookup"><span data-stu-id="e22d6-204">100</span></span> |

## <a name="get-the-most-relevant-emails"></a><span data-ttu-id="e22d6-205">Obter os emails mais relevantes</span><span class="sxs-lookup"><span data-stu-id="e22d6-205">Get the most relevant emails</span></span>

<span data-ttu-id="e22d6-206">Quando você pesquisa na entidade **mensagem**, a especificação de **enableTopResults** como`true` retorna uma lista híbrida de mensagens: as três primeiras mensagens na resposta são classificadas por relevância; as mensagens restantes são classificadas por data/hora.</span><span class="sxs-lookup"><span data-stu-id="e22d6-206">When searching the **message** entity, specifying **enableTopResults** as `true` returns a hybrid list of messages: the first three messages in the response are sorted by relevance; the remaining messages are sorted by date/time.</span></span>

## <a name="get-selected-properties"></a><span data-ttu-id="e22d6-207">Obter as propriedades selecionadas</span><span class="sxs-lookup"><span data-stu-id="e22d6-207">Get selected properties</span></span>

<span data-ttu-id="e22d6-p110">When searching an entity type, such as **message**, **event**, **drive**, **driveItem**, **list**, **listItem**, **site**, **externalItem**, you can include in the **fields** property specific entity properties to return in the search results. This is similar to using the [OData system query option, $select](/graph/query-parameters#select-parameter) in REST requests. The search API does not technically support these query options because the behavior is expressed in the POST body.</span><span class="sxs-lookup"><span data-stu-id="e22d6-p110">When searching an entity type, such as **message**, **event**, **drive**, **driveItem**, **list**, **listItem**, **site**, **externalItem**, you can include in the **fields** property specific entity properties to return in the search results. This is similar to using the [OData system query option, $select](/graph/query-parameters#select-parameter) in REST requests. The search API does not technically support these query options because the behavior is expressed in the POST body.</span></span>

<span data-ttu-id="e22d6-211">Para todos esses tipos de entidade, especificar a propriedade **campos** reduz o número de propriedades retornadas na resposta, melhorando a carga na conexão.</span><span class="sxs-lookup"><span data-stu-id="e22d6-211">For all these entity types, specifying the **fields** property reduces the number of properties returned in the response, optimizing the payload over the wire.</span></span>

<span data-ttu-id="e22d6-p111">The **listItem** and **externalItem** entities are the only supported entities that allow getting extended fields configured in the schema. You cannot retrieve extended properties from all the other entities. For example, if you created a field for **externalItem** in the search schema, or if you have a custom column on a **listItem**, you can retrieve these properties from search. To retrieve an extended property on a file, specify the **listItem** type in the request.</span><span class="sxs-lookup"><span data-stu-id="e22d6-p111">The **listItem** and **externalItem** entities are the only supported entities that allow getting extended fields configured in the schema. You cannot retrieve extended properties from all the other entities. For example, if you created a field for **externalItem** in the search schema, or if you have a custom column on a **listItem**, you can retrieve these properties from search. To retrieve an extended property on a file, specify the **listItem** type in the request.</span></span>

<span data-ttu-id="e22d6-p112">If the **fields** specified in the request are not present in the schema, they will not be returned in the response. Invalid fields in the request are silently ignored.</span><span class="sxs-lookup"><span data-stu-id="e22d6-p112">If the **fields** specified in the request are not present in the schema, they will not be returned in the response. Invalid fields in the request are silently ignored.</span></span>

<span data-ttu-id="e22d6-p113">If you do not specify any **fields** in the request,  you will get the default set of properties for all types. For extended properties, **listItem** and **externalItem** behave differently when no **fields** are passed in the request:</span><span class="sxs-lookup"><span data-stu-id="e22d6-p113">If you do not specify any **fields** in the request,  you will get the default set of properties for all types. For extended properties, **listItem** and **externalItem** behave differently when no **fields** are passed in the request:</span></span>

- <span data-ttu-id="e22d6-220">**listItem** não retornará nenhum campo personalizado.</span><span class="sxs-lookup"><span data-stu-id="e22d6-220">**listItem** will not return any custom field.</span></span>
- <span data-ttu-id="e22d6-221">**externalItem** retornará todos os campos marcados com o atributo **recuperável** no esquema do conector do Microsoft Graph para essa conexão em particular.</span><span class="sxs-lookup"><span data-stu-id="e22d6-221">**externalItem** will return all the fields marked with the **retrievable** attribute in the Microsoft Graph connector schema for that particular connection.</span></span>

## <a name="keyword-query-language-kql-support"></a><span data-ttu-id="e22d6-222">Suporte a KQL (Linguagem de Consulta de Palavra-chave)</span><span class="sxs-lookup"><span data-stu-id="e22d6-222">Keyword Query Language (KQL) support</span></span>

<span data-ttu-id="e22d6-p114">Specify free text keywords, operators (such as `AND`, `OR`), and property restrictions in KQL syntax in the actual search query string (**query** property of the **query** request body). The syntax and command depend on the entity types (in the **entityTypes** property) you target in the same **query** request body.</span><span class="sxs-lookup"><span data-stu-id="e22d6-p114">Specify free text keywords, operators (such as `AND`, `OR`), and property restrictions in KQL syntax in the actual search query string (**query** property of the **query** request body). The syntax and command depend on the entity types (in the **entityTypes** property) you target in the same **query** request body.</span></span>

<span data-ttu-id="e22d6-p115">Depending on the entity type, the searchable properties vary. For details, see:</span><span class="sxs-lookup"><span data-stu-id="e22d6-p115">Depending on the entity type, the searchable properties vary. For details, see:</span></span>

- [<span data-ttu-id="e22d6-227">Propriedades do email</span><span class="sxs-lookup"><span data-stu-id="e22d6-227">Email properties</span></span>](/microsoft-365/compliance/keyword-queries-and-search-conditions#searchable-email-properties)
- [<span data-ttu-id="e22d6-228">Propriedades do site</span><span class="sxs-lookup"><span data-stu-id="e22d6-228">Site properties</span></span>](/microsoft-365/compliance/keyword-queries-and-search-conditions#searchable-site-properties)

## <a name="sort-search-results"></a><span data-ttu-id="e22d6-229">Classificar resultados de pesquisa</span><span class="sxs-lookup"><span data-stu-id="e22d6-229">Sort search results</span></span>

<span data-ttu-id="e22d6-230">Os resultados da pesquisa na resposta são classificados na ordem de classificação padrão a seguir:</span><span class="sxs-lookup"><span data-stu-id="e22d6-230">Search results in the response are sorted in the following default sort order:</span></span>

- <span data-ttu-id="e22d6-231">**mensagem** e **evento** são classificados por data.</span><span class="sxs-lookup"><span data-stu-id="e22d6-231">**message** and **event** are sorted by date.</span></span>
- <span data-ttu-id="e22d6-232">Todos os tipos de conectores SharePoint e OneDrive são classificados por relevância.</span><span class="sxs-lookup"><span data-stu-id="e22d6-232">All SharePoint, OneDrive and connector types are sorted by relevance.</span></span>

<span data-ttu-id="e22d6-p116">The [query](../api/search-query.md) method lets you customize the search order by specifying the **sortProperties** on the `requests` parameter, which is a collection of [searchRequest](./searchrequest.md) objects. This allows you to specify a list of one or more sortable properties and the sort order.</span><span class="sxs-lookup"><span data-stu-id="e22d6-p116">The [query](../api/search-query.md) method lets you customize the search order by specifying the **sortProperties** on the `requests` parameter, which is a collection of [searchRequest](./searchrequest.md) objects. This allows you to specify a list of one or more sortable properties and the sort order.</span></span>

<span data-ttu-id="e22d6-235">Atualmente, só há suporte para a classificação de resultados nos seguintes tipos de SharePoint e OneDrive: [driveItem](driveitem.md), [listItem](listitem.md), [list](list.md) e [site](site.md).</span><span class="sxs-lookup"><span data-stu-id="e22d6-235">Note that sorting results is currently only supported on the following SharePoint and OneDrive types: [driveItem](driveitem.md), [listItem](listitem.md), [list](list.md), [site](site.md).</span></span>

<span data-ttu-id="e22d6-p117">The properties on which the sort clause are applied need to be sortable in the SharePoint [search schema](/sharepoint/manage-search-schema). If the property specified in the request is not sortable or does not exist, the response will return an error, `HTTP 400 Bad Request`. Note that you cannot specify to sort documents by relevance using [sortProperty](sortproperty.md).</span><span class="sxs-lookup"><span data-stu-id="e22d6-p117">The properties on which the sort clause are applied need to be sortable in the SharePoint [search schema](/sharepoint/manage-search-schema). If the property specified in the request is not sortable or does not exist, the response will return an error, `HTTP 400 Bad Request`. Note that you cannot specify to sort documents by relevance using [sortProperty](sortproperty.md).</span></span>

<span data-ttu-id="e22d6-239">Ao especificar o **nome** de um objeto [sortProperty](sortproperty.md), você pode usar o nome da propriedade do tipo Microsoft Graph (por exemplo, em [driveItem](driveitem.md)) ou o nome da propriedade gerenciada no índice de pesquisa.</span><span class="sxs-lookup"><span data-stu-id="e22d6-239">When specifying the **name** of a [sortProperty](sortproperty.md) object, you can either use the property name from the Microsoft Graph type (for example, in [driveItem](driveitem.md)), or the name of the managed property in the search index.</span></span>

<span data-ttu-id="e22d6-240">Confira [classificar resultados de pesquisa](/graph/search-concept-sort) para obter exemplos que mostram como classificar resultados.</span><span class="sxs-lookup"><span data-stu-id="e22d6-240">See [sort search results](/graph/search-concept-sort) for examples that show how to sort results.</span></span>

## <a name="refine-results-using-aggregations"></a><span data-ttu-id="e22d6-241">Refinar os resultados usando agregações</span><span class="sxs-lookup"><span data-stu-id="e22d6-241">Refine results using aggregations</span></span>

<span data-ttu-id="e22d6-p118">Aggregations (also known as refiners in SharePoint) are a very popular way to enhance a search experience. In addition to the results, they provide some level of aggregate information on the matching set of search results. For example, you can provide information on the most represented authors of the documents matching the query, or the most represented file types, etc.</span><span class="sxs-lookup"><span data-stu-id="e22d6-p118">Aggregations (also known as refiners in SharePoint) are a very popular way to enhance a search experience. In addition to the results, they provide some level of aggregate information on the matching set of search results. For example, you can provide information on the most represented authors of the documents matching the query, or the most represented file types, etc.</span></span>

<span data-ttu-id="e22d6-p119">In the [searchRequest](./searchrequest.md), specify the aggregations that should be returned in addition to the search results. The description of each aggregation is defined in the [aggregationOption](./aggregationoption.md), which specifies the property on which the aggregation should be computed, and the number of [searchBucket](searchBucket.md) to be returned in the response.</span><span class="sxs-lookup"><span data-stu-id="e22d6-p119">In the [searchRequest](./searchrequest.md), specify the aggregations that should be returned in addition to the search results. The description of each aggregation is defined in the [aggregationOption](./aggregationoption.md), which specifies the property on which the aggregation should be computed, and the number of [searchBucket](searchBucket.md) to be returned in the response.</span></span>

<span data-ttu-id="e22d6-p120">The properties on which the aggregation is requested need to be refinable in the SharePoint [search schema](/sharepoint/manage-search-schema). If the property specified is not refinable or does not exist, the response returns `HTTP 400 Bad Request`.</span><span class="sxs-lookup"><span data-stu-id="e22d6-p120">The properties on which the aggregation is requested need to be refinable in the SharePoint [search schema](/sharepoint/manage-search-schema). If the property specified is not refinable or does not exist, the response returns `HTTP 400 Bad Request`.</span></span>

<span data-ttu-id="e22d6-p121">Once the response is returned containing the collection of [searchBucket](searchBucket.md) objects, it is possible to refine the search request to only the matching elements contained in one [searchBucket](searchBucket.md). This is achieved by passing back the  **aggregationsFilterToken** value in the **aggregationFilters** property of the subsequent [searchRequest](./searchrequest.md).</span><span class="sxs-lookup"><span data-stu-id="e22d6-p121">Once the response is returned containing the collection of [searchBucket](searchBucket.md) objects, it is possible to refine the search request to only the matching elements contained in one [searchBucket](searchBucket.md). This is achieved by passing back the  **aggregationsFilterToken** value in the **aggregationFilters** property of the subsequent [searchRequest](./searchrequest.md).</span></span>

<span data-ttu-id="e22d6-p122">Aggregations are currently only supported on the following SharePoint and OneDrive types: [driveItem](driveitem.md), [listItem](listitem.md), [list](list.md), [site](site.md). Soon they will be supported for refinable properties in [externalItem](externalItem.md) of Microsoft Graph connectors.</span><span class="sxs-lookup"><span data-stu-id="e22d6-p122">Aggregations are currently only supported on the following SharePoint and OneDrive types: [driveItem](driveitem.md), [listItem](listitem.md), [list](list.md), [site](site.md). Soon they will be supported for refinable properties in [externalItem](externalItem.md) of Microsoft Graph connectors.</span></span>

<span data-ttu-id="e22d6-253">Confira [refinar os resultados da pesquisa](/graph/search-concept-aggregation) para obter exemplos que mostram como usar a agregação para melhorar e restringir os resultados da pesquisa.</span><span class="sxs-lookup"><span data-stu-id="e22d6-253">See [refine search results](/graph/search-concept-aggregation) for examples that show using aggregation to enhance and narrow down search results.</span></span>

## <a name="error-handling"></a><span data-ttu-id="e22d6-254">Tratamento de erros</span><span class="sxs-lookup"><span data-stu-id="e22d6-254">Error handling</span></span>

<span data-ttu-id="e22d6-255">A API de pesquisa retorna respostas de erro conforme estipulado pela [definição de objeto de erro OData](http://docs.oasis-open.org/odata/odata-json-format/v4.01/cs01/odata-json-format-v4.01-cs01.html#sec_ErrorResponse). Cada uma delas é um objeto JSON que contém um código e uma mensagem.</span><span class="sxs-lookup"><span data-stu-id="e22d6-255">The search API returns error responses as defined by [OData error object definition](http://docs.oasis-open.org/odata/odata-json-format/v4.01/cs01/odata-json-format-v4.01-cs01.html#sec_ErrorResponse), each of which is a JSON object containing a code and a message.</span></span>

<!---TODOSEARCHAPI Describe the know errors: bad requests.--->

## <a name="known-limitations"></a><span data-ttu-id="e22d6-256">Limitações conhecidas</span><span class="sxs-lookup"><span data-stu-id="e22d6-256">Known limitations</span></span>

<span data-ttu-id="e22d6-257">A API de pesquisa tem as seguintes limitações:</span><span class="sxs-lookup"><span data-stu-id="e22d6-257">The search API has the following limitations:</span></span>

- <span data-ttu-id="e22d6-p123">The **query** method is defined to allow passing a collection of one or more **searchRequest** instances at once. However, the service currently supports only a single [searchRequest](./searchrequest.md) at a time.</span><span class="sxs-lookup"><span data-stu-id="e22d6-p123">The **query** method is defined to allow passing a collection of one or more **searchRequest** instances at once. However, the service currently supports only a single [searchRequest](./searchrequest.md) at a time.</span></span>

- <span data-ttu-id="e22d6-p124">The [searchRequest](./searchrequest.md) resource supports passing multiple types of entities at a time. However, currently the only supported combination is for SharePoint and OneDrive entityTypes: **driveItem**, **drive**, **site**, **list**, **listItem**. Any combinations involving **message**, **event**, SharePoint and OneDrive types , or **externalItem** are currently not supported.</span><span class="sxs-lookup"><span data-stu-id="e22d6-p124">The [searchRequest](./searchrequest.md) resource supports passing multiple types of entities at a time. However, currently the only supported combination is for SharePoint and OneDrive entityTypes: **driveItem**, **drive**, **site**, **list**, **listItem**. Any combinations involving **message**, **event**, SharePoint and OneDrive types , or **externalItem** are currently not supported.</span></span>  

- <span data-ttu-id="e22d6-263">A propriedade **contentSource**, que define a conexão a ser usada, só será aplicável quando **entityType** for especificada como `externalItem`.</span><span class="sxs-lookup"><span data-stu-id="e22d6-263">The **contentSource** property, which defines the connection to use, is only applicable when **entityType** is specified as `externalItem`.</span></span>

- <span data-ttu-id="e22d6-264">A API de pesquisa não dá suporte à classificação personalizada para **mensagem**, **evento** ou  **externalItem**.</span><span class="sxs-lookup"><span data-stu-id="e22d6-264">The search API does not support custom sort for **message**, **event** or  **externalItem**.</span></span>

- <span data-ttu-id="e22d6-265">A API de pesquisa não dá suporte a agregações para **mensagem**, **evento**, **site** ou **unidade**.</span><span class="sxs-lookup"><span data-stu-id="e22d6-265">The search API does not support aggregations for **message**, **event**, **site** or **drive**.</span></span>

## <a name="schema-change-deprecation-warning"></a><span data-ttu-id="e22d6-266">Aviso de preterição de mudança de esquema</span><span class="sxs-lookup"><span data-stu-id="e22d6-266">Schema change deprecation warning</span></span>

<span data-ttu-id="e22d6-p125">Properties used in a search request and response have been renamed or removed. In most cases, the original properties are being deprecated and replaced by the current properties, as listed in the table below.</span><span class="sxs-lookup"><span data-stu-id="e22d6-p125">Properties used in a search request and response have been renamed or removed. In most cases, the original properties are being deprecated and replaced by the current properties, as listed in the table below.</span></span>

<span data-ttu-id="e22d6-p126">Start updating any existing apps to use current property and type names, and to get current property names in the response. For backward compatibility, the original properties and types are accessible and functional until **December 31, 2020**, after which they will be removed.</span><span class="sxs-lookup"><span data-stu-id="e22d6-p126">Start updating any existing apps to use current property and type names, and to get current property names in the response. For backward compatibility, the original properties and types are accessible and functional until **December 31, 2020**, after which they will be removed.</span></span>

| <span data-ttu-id="e22d6-271">Recurso</span><span class="sxs-lookup"><span data-stu-id="e22d6-271">Resource</span></span>                           | <span data-ttu-id="e22d6-272">Tipo de alteração</span><span class="sxs-lookup"><span data-stu-id="e22d6-272">Change type</span></span>   | <span data-ttu-id="e22d6-273">Propriedade original</span><span class="sxs-lookup"><span data-stu-id="e22d6-273">Original property</span></span> | <span data-ttu-id="e22d6-274">Propriedade atual</span><span class="sxs-lookup"><span data-stu-id="e22d6-274">Current property</span></span>|
|:-----------------------------------|:--------------|:------------------|:----------------|
| [<span data-ttu-id="e22d6-275">searchRequest</span><span class="sxs-lookup"><span data-stu-id="e22d6-275">searchRequest</span></span>](./searchrequest.md)| <span data-ttu-id="e22d6-276">Renomear Propriedade</span><span class="sxs-lookup"><span data-stu-id="e22d6-276">Rename property</span></span> | <span data-ttu-id="e22d6-277">**stored_fields**</span><span class="sxs-lookup"><span data-stu-id="e22d6-277">**stored_fields**</span></span> | <span data-ttu-id="e22d6-278">**campos**</span><span class="sxs-lookup"><span data-stu-id="e22d6-278">**fields**</span></span>      |
| [<span data-ttu-id="e22d6-279">searchQuery</span><span class="sxs-lookup"><span data-stu-id="e22d6-279">searchQuery</span></span>](./searchquery.md)    | <span data-ttu-id="e22d6-280">Renomear propriedade</span><span class="sxs-lookup"><span data-stu-id="e22d6-280">Rename property</span></span> | <span data-ttu-id="e22d6-281">**query_string**</span><span class="sxs-lookup"><span data-stu-id="e22d6-281">**query_string**</span></span> | <span data-ttu-id="e22d6-282">**queryString**</span><span class="sxs-lookup"><span data-stu-id="e22d6-282">**queryString**</span></span> |
| [<span data-ttu-id="e22d6-283">searchQueryString</span><span class="sxs-lookup"><span data-stu-id="e22d6-283">searchQueryString</span></span>](./searchquerystring.md) | <span data-ttu-id="e22d6-284">Substituir recurso</span><span class="sxs-lookup"><span data-stu-id="e22d6-284">Deprecate resource</span></span> | <span data-ttu-id="e22d6-285">Não aplicável</span><span class="sxs-lookup"><span data-stu-id="e22d6-285">Not applicable</span></span> | <span data-ttu-id="e22d6-286">Não aplicável</span><span class="sxs-lookup"><span data-stu-id="e22d6-286">Not applicable</span></span> |
| [<span data-ttu-id="e22d6-287">searchHit</span><span class="sxs-lookup"><span data-stu-id="e22d6-287">searchHit</span></span>](./searchhit.md)        | <span data-ttu-id="e22d6-288">Renomear propriedade</span><span class="sxs-lookup"><span data-stu-id="e22d6-288">Rename property</span></span> | <span data-ttu-id="e22d6-289">**_id**</span><span class="sxs-lookup"><span data-stu-id="e22d6-289">**_id**</span></span> | <span data-ttu-id="e22d6-290">**hitId**</span><span class="sxs-lookup"><span data-stu-id="e22d6-290">**hitId**</span></span> |
| [<span data-ttu-id="e22d6-291">searchHit</span><span class="sxs-lookup"><span data-stu-id="e22d6-291">searchHit</span></span>](./searchhit.md)        | <span data-ttu-id="e22d6-292">Renomear propriedade</span><span class="sxs-lookup"><span data-stu-id="e22d6-292">Rename property</span></span> | <span data-ttu-id="e22d6-293">**_score**</span><span class="sxs-lookup"><span data-stu-id="e22d6-293">**_score**</span></span> | <span data-ttu-id="e22d6-294">**classificação**</span><span class="sxs-lookup"><span data-stu-id="e22d6-294">**rank**</span></span> |
| [<span data-ttu-id="e22d6-295">searchHit</span><span class="sxs-lookup"><span data-stu-id="e22d6-295">searchHit</span></span>](./searchhit.md)        | <span data-ttu-id="e22d6-296">Remover propriedade</span><span class="sxs-lookup"><span data-stu-id="e22d6-296">Remove property</span></span> | <span data-ttu-id="e22d6-297">**_sortField**</span><span class="sxs-lookup"><span data-stu-id="e22d6-297">**_sortField**</span></span> | <span data-ttu-id="e22d6-298">Não aplicável</span><span class="sxs-lookup"><span data-stu-id="e22d6-298">Not applicable</span></span> |
| [<span data-ttu-id="e22d6-299">searchHit</span><span class="sxs-lookup"><span data-stu-id="e22d6-299">searchHit</span></span>](./searchhit.md)        | <span data-ttu-id="e22d6-300">Renomear propriedade</span><span class="sxs-lookup"><span data-stu-id="e22d6-300">Rename property</span></span> | <span data-ttu-id="e22d6-301">**_source**</span><span class="sxs-lookup"><span data-stu-id="e22d6-301">**_source**</span></span> | <span data-ttu-id="e22d6-302">**recurso**</span><span class="sxs-lookup"><span data-stu-id="e22d6-302">**resource**</span></span> |
| [<span data-ttu-id="e22d6-303">searchHit</span><span class="sxs-lookup"><span data-stu-id="e22d6-303">searchHit</span></span>](./searchhit.md)        | <span data-ttu-id="e22d6-304">Renomear propriedade</span><span class="sxs-lookup"><span data-stu-id="e22d6-304">Rename property</span></span> | <span data-ttu-id="e22d6-305">**_summary**</span><span class="sxs-lookup"><span data-stu-id="e22d6-305">**_summary**</span></span>  | <span data-ttu-id="e22d6-306">**resumo**</span><span class="sxs-lookup"><span data-stu-id="e22d6-306">**summary**</span></span>  |

## <a name="search-samples"></a><span data-ttu-id="e22d6-307">Exemplos de pesquisa</span><span class="sxs-lookup"><span data-stu-id="e22d6-307">Search samples</span></span>

- <span data-ttu-id="e22d6-308">Saiba mais sobre alguns dos principais casos de uso:</span><span class="sxs-lookup"><span data-stu-id="e22d6-308">Learn more about a few key use cases:</span></span>
  - [<span data-ttu-id="e22d6-309">Pesquisar mensagens do Outlook</span><span class="sxs-lookup"><span data-stu-id="e22d6-309">Search Outlook messages</span></span>](/graph/search-concept-messages)
  - [<span data-ttu-id="e22d6-310">Pesquisar eventos do calendário</span><span class="sxs-lookup"><span data-stu-id="e22d6-310">Search calendar events</span></span>](/graph/search-concept-events)
  - [<span data-ttu-id="e22d6-311">Pesquisar conteúdo no OneDrive e Microsoft Office SharePoint Online</span><span class="sxs-lookup"><span data-stu-id="e22d6-311">Search content in Sharepoint and OneDrive</span></span>](/graph/search-concept-files)
  - [<span data-ttu-id="e22d6-312">Pesquisar conteúdo externo</span><span class="sxs-lookup"><span data-stu-id="e22d6-312">Search external content</span></span>](/graph/search-concept-custom-types)
  - [<span data-ttu-id="e22d6-313">Classificar resultados de pesquisa</span><span class="sxs-lookup"><span data-stu-id="e22d6-313">Sort search results</span></span>](/graph/search-concept-sort)
  - [<span data-ttu-id="e22d6-314">Refinar resultados de pesquisa</span><span class="sxs-lookup"><span data-stu-id="e22d6-314">Refine search results</span></span>](/graph/search-concept-aggregation)

- <span data-ttu-id="e22d6-315">Explore as APIs no [Explorador do Graph](https://developer.microsoft.com/graph/graph-explorer).</span><span class="sxs-lookup"><span data-stu-id="e22d6-315">Explore the search APIs in  [Graph Explorer](https://developer.microsoft.com/graph/graph-explorer).</span></span>


## <a name="whats-new"></a><span data-ttu-id="e22d6-316">O que há de novo</span><span class="sxs-lookup"><span data-stu-id="e22d6-316">What's new</span></span>

<span data-ttu-id="e22d6-317">Saiba mais sobre os [novos recursos e atualizações mais recentes](/graph/whats-new-overview) para este conjunto de APIs.</span><span class="sxs-lookup"><span data-stu-id="e22d6-317">Find out about the [latest new features and updates](/graph/whats-new-overview) for this API set.</span></span>