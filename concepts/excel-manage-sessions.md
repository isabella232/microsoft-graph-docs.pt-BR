---
title: Gerenciar sessões e persistências no Excel usando o Microsoft Graph
description: Se o aplicativo precisar realizar mais do que uma ou duas chamadas à API do Excel, você deve criar uma sessão e passar a ID da sessão com cada solicitação. A presença de uma ID de sessão na solicitação garante que você esteja usando a API do Excel da maneira mais eficiente possível.
localization_priority: Normal
author: lumine2008
ms.prod: excel
ms.openlocfilehash: 488637f53ffc1298420d40e93f3f5d9fd7a0b518
ms.sourcegitcommit: 3fbc2249b307e8d3a9de18f22ef6911094ca272c
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/26/2020
ms.locfileid: "48289222"
---
# <a name="manage-sessions-and-persistence-in-excel-with-microsoft-graph"></a><span data-ttu-id="6ab18-104">Gerenciar sessões e persistências no Excel usando o Microsoft Graph</span><span class="sxs-lookup"><span data-stu-id="6ab18-104">Manage sessions and persistence in Excel with Microsoft Graph</span></span>

<span data-ttu-id="6ab18-105">Se o aplicativo precisar realizar mais do que uma ou duas chamadas à API do Excel, você deve criar uma sessão e passar a ID da sessão com cada solicitação.</span><span class="sxs-lookup"><span data-stu-id="6ab18-105">If your application needs to make more than one or two calls to the Excel API, you should create a session and pass the session Id with each request.</span></span> <span data-ttu-id="6ab18-106">A presença de uma ID de sessão na solicitação garante que você esteja usando a API do Excel da maneira mais eficiente possível.</span><span class="sxs-lookup"><span data-stu-id="6ab18-106">The presence of a session Id in the requests ensures that you are using the Excel API in the most efficient way possible.</span></span>

<span data-ttu-id="6ab18-107">As APIs do Excel podem ser chamadas em um destes três modos:</span><span class="sxs-lookup"><span data-stu-id="6ab18-107">Excel APIs are called in one of three modes:</span></span>

1. <span data-ttu-id="6ab18-108">**Sessão persistente** Todas as alterações feitas na pasta de trabalho são persistentes (salvas) na pasta de trabalho.</span><span class="sxs-lookup"><span data-stu-id="6ab18-108">**Persistent session**  All changes made to the workbook are persisted (saved) to the workbook.</span></span> <span data-ttu-id="6ab18-109">Esse uso da API do Excel é o método mais eficiente e que oferece o melhor desempenho.</span><span class="sxs-lookup"><span data-stu-id="6ab18-109">This is the most efficient and best-performing way to use the Excel API.</span></span>
2. <span data-ttu-id="6ab18-110">**Sessão não persistente** As alterações feitas pela API não são salvas na localização de origem.</span><span class="sxs-lookup"><span data-stu-id="6ab18-110">**Non-persistent session**  Changes made by the API are not saved to the source location.</span></span> <span data-ttu-id="6ab18-111">Em vez disso, o servidor back-end do Excel mantém uma cópia temporária do arquivo que reflete as alterações feitas durante essa sessão de API específica.</span><span class="sxs-lookup"><span data-stu-id="6ab18-111">Instead, the Excel backend server keeps a temporary copy of the file that reflects the changes made during that particular API session.</span></span> <span data-ttu-id="6ab18-112">Quando a sessão do Excel expirar, as alterações serão perdidas.</span><span class="sxs-lookup"><span data-stu-id="6ab18-112">When the Excel session expires, the changes are lost.</span></span> <span data-ttu-id="6ab18-113">Esse modo é útil para aplicativos que precisam fazer uma análise ou obter os resultados de um cálculo ou de uma imagem de gráfico, mas não precisa afetar o estado do documento.</span><span class="sxs-lookup"><span data-stu-id="6ab18-113">This mode is useful for apps that need to do analysis or obtain the results of a calculation or a chart image, but do not need to affect the document state.</span></span>
3. <span data-ttu-id="6ab18-114">**Sem sessão** As chamadas da API não passam um ID de sessão. Os servidores do Excel precisam localizar a cópia do servidor da pasta de trabalho para cada operação.</span><span class="sxs-lookup"><span data-stu-id="6ab18-114">**Sessionless**  The API calls do not pass a session Id. The Excel servers have to locate the server's copy of the workbook for each operation.</span></span> <span data-ttu-id="6ab18-115">Essa não é uma maneira eficiente para chamar a API do Excel, mas ela é adequada para fazer certos tipos de solicitações isoladas.</span><span class="sxs-lookup"><span data-stu-id="6ab18-115">This is not an efficient way to call the Excel API, but it is suitable for making certain types of isolated requests.</span></span>

<span data-ttu-id="6ab18-116">Para representar a sessão na API, use o cabeçalho `workbook-session-id: {session-id}`.</span><span class="sxs-lookup"><span data-stu-id="6ab18-116">To represent the session in the API, use the `workbook-session-id: {session-id}` header.</span></span>

><span data-ttu-id="6ab18-p106">**Observação:** o cabeçalho de sessão não é obrigatório para uma API do Excel funcionar. No entanto, recomendamos que você use o cabeçalho de sessão para melhorar o desempenho. Se você não usar um cabeçalho de sessão, as alterações feitas durante a chamada à API _serão_ mantidas como persistentes no arquivo.</span><span class="sxs-lookup"><span data-stu-id="6ab18-p106">**Note:** The session header is not required for an Excel API to work. However, we recommend that you use the session header to improve performance. If you don't use a session header, changes made during the API call _are_ persisted to the file.</span></span>  

## <a name="request-types"></a><span data-ttu-id="6ab18-120">Tipos de solicitação</span><span class="sxs-lookup"><span data-stu-id="6ab18-120">Request types</span></span>
<span data-ttu-id="6ab18-121">O [tratamento de erros](workbook-error-handling.md) sugerido para APIs do Excel é baseado no tipo de solicitação, código de erro e código de status.</span><span class="sxs-lookup"><span data-stu-id="6ab18-121">Suggested [error handling](workbook-error-handling.md) for Excel APIs is based on request type, error code, and status code.</span></span> <span data-ttu-id="6ab18-122">Estes são os tipos de solicitação:</span><span class="sxs-lookup"><span data-stu-id="6ab18-122">The following are the request types:</span></span>

- <span data-ttu-id="6ab18-123">**Solicitação CreateSession** -usada para criar uma sessão persistente ou não persistente.</span><span class="sxs-lookup"><span data-stu-id="6ab18-123">**CreateSession request** - Used to create either a persistent or a non-persistent session.</span></span> <span data-ttu-id="6ab18-124">Em uma resposta bem-sucedida, a ID da sessão será retornada na propriedade **ID** no corpo da resposta.</span><span class="sxs-lookup"><span data-stu-id="6ab18-124">In a successful response, the session ID will be returned in the **id** property in the response body.</span></span> <span data-ttu-id="6ab18-125">Para obter detalhes, consulte [Create Session](/graph/api/workbook-createsession?view=graph-rest-1.0).</span><span class="sxs-lookup"><span data-stu-id="6ab18-125">For details, see [Create session](/graph/api/workbook-createsession?view=graph-rest-1.0).</span></span>
- <span data-ttu-id="6ab18-126">**Solicitação de sessão** -solicitações subsequentes que seguem uma solicitação CreateSession.</span><span class="sxs-lookup"><span data-stu-id="6ab18-126">**Sessionful request** - Subsequent requests that follow a CreateSession request.</span></span> <span data-ttu-id="6ab18-127">Em geral, eles incluem um `workbook-session-id: {session-id}` cabeçalho.</span><span class="sxs-lookup"><span data-stu-id="6ab18-127">They usually include a `workbook-session-id: {session-id}` header.</span></span> <span data-ttu-id="6ab18-128">A exceção é uma solicitação de status de sondagem, que usa o padrão de operação de execução longa.</span><span class="sxs-lookup"><span data-stu-id="6ab18-128">The exception is a poll status request, which uses the long-running operation pattern.</span></span> <span data-ttu-id="6ab18-129">Para obter detalhes, consulte [Working with APIs que levam muito tempo para ser concluído](./workbook-best-practice.md#working-with-apis-that-take-a-long-time-to-complete).</span><span class="sxs-lookup"><span data-stu-id="6ab18-129">For details, see [working with APIs that take a long time to complete](./workbook-best-practice.md#working-with-apis-that-take-a-long-time-to-complete).</span></span>
- <span data-ttu-id="6ab18-130">**Solicitação sem sessão** -usada no modo sem sessão.</span><span class="sxs-lookup"><span data-stu-id="6ab18-130">**Sessionless request** - Used in Sessionless mode.</span></span> <span data-ttu-id="6ab18-131">Essas solicitações não têm um `workbook-session-id: {session-id}` cabeçalho.</span><span class="sxs-lookup"><span data-stu-id="6ab18-131">These requests don't have a `workbook-session-id: {session-id}` header.</span></span>  

## <a name="next-steps"></a><span data-ttu-id="6ab18-132">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="6ab18-132">Next steps</span></span>
<span data-ttu-id="6ab18-133">Para saber como criar e usar sessões, confira o [tópico de referência de criação de sessão](/graph/api/workbook-createsession?view=graph-rest-1.0).</span><span class="sxs-lookup"><span data-stu-id="6ab18-133">To learn how to create and use sessions, see the [Create session reference topic](/graph/api/workbook-createsession?view=graph-rest-1.0).</span></span>

## <a name="see-also"></a><span data-ttu-id="6ab18-134">Confira também</span><span class="sxs-lookup"><span data-stu-id="6ab18-134">See also</span></span>
* [<span data-ttu-id="6ab18-135">Gravar em uma pasta de trabalho do Excel usando o Microsoft Graph</span><span class="sxs-lookup"><span data-stu-id="6ab18-135">Write to an Excel workbook using Microsoft Graph</span></span>](excel-write-to-workbook.md)
* [<span data-ttu-id="6ab18-136">Usar funções de pasta de trabalho do Excel com o Microsoft Graph</span><span class="sxs-lookup"><span data-stu-id="6ab18-136">Use workbook functions in Excel with Microsoft Graph</span></span>](excel-use-functions.md)
* [<span data-ttu-id="6ab18-137">Atualizar um formato de intervalo no Excel com o Microsoft Graph</span><span class="sxs-lookup"><span data-stu-id="6ab18-137">Update a range’s format in Excel with Microsoft Graph</span></span>](excel-update-range-format.md)
* [<span data-ttu-id="6ab18-138">Exibir uma imagem do gráfico do Excel com o Microsoft Graph</span><span class="sxs-lookup"><span data-stu-id="6ab18-138">Display a chart image in Excel with Microsoft Graph</span></span>](excel-display-chart-image.md)
* [<span data-ttu-id="6ab18-139">Usar a API REST do Excel</span><span class="sxs-lookup"><span data-stu-id="6ab18-139">Use the Excel REST API</span></span>](/graph/api/resources/excel?view=graph-rest-1.0)